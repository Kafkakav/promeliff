import{u as e,r as s,o as t,d as o,f as r,e as a,t as n,c as l,s as c,a as i,j as u}from"./Biz0ScVy.js";import{a as d}from"./DqkGgfGl.js";const p=d.create({headers:{Accept:"application/json","Content-Type":"application/json"},timeout:5e4});p.interceptors.request.use((e=>((e.headers||{}).isToken,e.headers["User-Agent"]="Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:122.0) Gecko/20100101 Firefox/122.0",e)),(e=>(console.error(e),Promise.reject(e)))),p.interceptors.response.use((function(e){if("blob"===e.request.responseType||"arraybuffer"===e.request.responseType)return e.data;const s=e.data.code||200;switch(s){case 400:case 401:return console.error("無法存取:",e.status),Promise.reject(`無法存取:${s}, status:${e.status}`);case 404:return console.error("頁面不存在"),Promise.reject("頁面不存在:404");case 500:return console.error("內部發生錯誤"),Promise.reject("內部發生錯誤")}return e.data}),(function(e){if(e.response)switch(e.response.status){case 400:case 401:console.error("無法存取:",e.response.status);break;case 404:console.error("頁面不存在");break;case 500:console.error("程式發生問題");break;default:console.error(e.message)}return Promise.reject(e.response)}));const m={class:"container-fluid",style:{margin:"0",padding:"0"}},f={class:"d-flex flex-wrap justify-content-center gap-2 w-100",style:{padding:"20px"}},g={class:"card card-fixed-wd"},y={class:"card-img-top"},h=["src"],v={class:"card-body"},b={key:0,class:"list-group list-group-flush"},w={key:0,class:"list-group-item"},k={key:1,class:"list-group-item",style:{color:"red"}},j={class:"list-group-item"},x={class:"list-group-item"},P={class:"card-footer d-flex flex-wrap justify-content-center"},C={__name:"CheckIn",setup(d){const p=i();e();const C=s(!1),T=s({lat:25.03418,lng:121.564087}),q=s("https://maps.google.com/maps?q=25.034180679449104,121.56408708529044&output=embed"),$=s(""),z=s("");function I(){C.value=!1,$.value="資料獲取中...","geolocation"in navigator?navigator.geolocation.getCurrentPosition((e=>{const s=Math.round(1e6*e.coords.latitude)/1e6,t=Math.round(1e6*e.coords.longitude)/1e6;T.value={lat:s,lng:t},q.value=`https://maps.google.com/maps?q=${s},${t}&output=embed`,$.value=""}),(e=>{l(`無法取得位置資訊${e.code} ${e.message||""}`,{autoClose:4e3}),$.value="無法取得位置資訊"})):(l("您的瀏覽器不支援地理定位功能。",{autoClose:4e3}),$.value="您的瀏覽器不支援地理定位功能"),new Promise((async(e,s)=>{try{const s=await fetch("https://api.ipify.org?format=json");e((await s.json()).ip)}catch(t){s(t.message||t.code)}})).then((e=>{z.value=e})).catch((e=>{z.value="error"})).finally((()=>{C.value=!0}))}return t((async()=>{})),(e,s)=>(u(),o("div",m,[r("div",f,[r("div",g,[r("div",y,[q.value.length>5?(u(),o("iframe",{key:0,width:"100%",height:"240",style:{border:"0"},loading:"lazy",allowfullscreen:"",referrerpolicy:"no-referrer-when-downgrade",src:q.value},null,8,h)):a("",!0)]),r("div",v,[s[3]||(s[3]=r("h4",{class:"card-title"},"打卡資訊",-1)),C.value?(u(),o("ul",b,[0==$.value.length?(u(),o("li",w,"GPS: "+n(T.value.lat)+","+n(T.value.lng),1)):a("",!0),$.value.length>0?(u(),o("li",k,"GPS: "+n($.value),1)):a("",!0),r("li",j,"IP: "+n(z.value),1),r("li",x,[r("button",{type:"button",class:"btn btn-outline-primary fixed-size me-2",onClick:s[0]||(s[0]=e=>{window.Swal.fire({icon:"question",title:"送出打卡資訊",showDenyButton:!0,confirmButtonText:"確認",denyButtonText:"取消"}).then((e=>{e.isConfirmed?console.log("checkIn: confirmed"):e.isDenied&&console.log("checkIn: canceled")}))})},"送出")])])):a("",!0)]),r("div",P,[r("button",{type:"button",class:"btn btn-outline-primary fixed-size me-2",onClick:s[1]||(s[1]=e=>I())},"打卡"),r("button",{type:"button",class:"btn btn-outline-primary fixed-size me-2",onClick:s[2]||(s[2]=e=>{c((()=>{p.push({name:"Home"})}))})},"回首頁")])])])]))}};export{C as default};
