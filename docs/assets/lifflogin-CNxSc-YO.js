import{g as e,_ as a,u as t,r as s,o,l,a as n,b as r,c as i,d,e as f,f as c,w as p,h as S,t as u,i as m,j as g}from"./index-Cf5JHqHO.js";import{_ as L}from"./prome_title-CrmojU54.js";import{a as v}from"./index-fZjk1EK6.js";const h="/promeliff/assets/prome_avatar-BmIlvr5V.jpg",U={401:"認證失敗，無法存取系統資源:401",403:"當前操作沒有權限:403",404:"存取資源不存在:404",default:"未知系統錯誤，請向管理員反應問題"};let C={show:!1};v.defaults.headers["Content-Type"]="application/json;charset=utf-8";const k=v.create({baseURL:"https://nozomiai.asuscomm.com/promeliff",timeout:12e3});k.interceptors.request.use((a=>(!(!1===(a.headers||{}).isToken)&&e()&&(a.headers.Authorization="Bearer "+e()),a)),(e=>{Promise.reject(e)})),k.interceptors.response.use((e=>{const a=e.data.code||200,t=U[a]||e.data.msg||U.default;return"blob"===e.request.responseType||"arraybuffer"===e.request.responseType?e.data:401===a?C.show?Promise.reject({error:"無效的session，或者會話已過期，請重新登錄。",code:a}):void(C.show=!0):500===a?Promise.reject(new Error(t)):200!==a?Promise.reject({error:"unknown error",code:a}):e.data}),(e=>{let a="x",{message:t}=e;return"Network Error"==t?t="後端連線異常":t.includes("timeout")?t="系統請求超時":t.includes("Request failed with status code")&&(a=t.substr(t.length-3),t=`系統${a}異常`),["400","403","404"].indexOf(a),e.response?Promise.reject({error:t,data:e.response.data||null,code:e.response.status||a}):Promise.reject(e)}));const K={class:"login"},P={key:0,class:"card"},b={key:1,class:"card"},A={class:"card-footer text-body-secondary"},F={key:0},x={key:1},y={key:2,class:"card"},j={class:"logo-banner"},E=a({__name:"lifflogin",setup(e){const a=t(),v=n(),U=s(null),C=s(!1),E=s(0),J=s("https://liff.line.me/2003978054-MNlNVly1");function w(e){if(!a.liffReady)return l.init({liffId:a.liffId}).then((()=>{})).catch((e=>{})),l.ready}function W(){let e=m("stepExtLogin");e&&911==e.yes?E.value=1:E.value=2}const B=()=>{a.fullscLoading=!0,a.liffReady?l.isInClient()?l.isLoggedIn()?v.push({name:"Home"}):w():l.isLoggedIn()?v.push({name:"Home"}):(C.value=!0,l.login({redirectUri:`${a.liffEPUrl}?longin=1`}),C.value=!1):w()},z=()=>new Promise(((e,t)=>{let s={liffId:a.liffId,accessToken:l.getAccessToken(),idToken:l.getIDToken()};var o;l.isLoggedIn(),(o=s,k({url:"/WdaG8atCBY/getoken",headers:{isToken:!1},method:"post",data:o})).then((a=>a.data&&a.data.token?(i("授權取得成功",{autoClose:4e3}),e(a.data)):(i("授權無法取得",{autoClose:4e3}),t({error:"no token acquired"})))).catch((e=>(a.liffReady=!1,i("授權失敗, 請關閉頁面",{autoClose:4e3}),t({error:"failed to get token"}))))}));return o((()=>{l.isLoggedIn()?z().then((e=>{a.setAuthToken(e),v.push({name:"Home"})})).catch((e=>{a.setAuthToken({token:"Fake-H99saGoCjD7ngi26sluCbzoSNLONBP8asx2abq2hfoENgK6n1mq4YuXJFAOnGRJC"}),v.push({name:"Home"})})).finally((()=>{W(),a.fullscLoading=!1})):(W(),a.fullscLoading=!1)})),r((()=>{a.fullscLoading=!0,a.liffReady||(w(),a.liffReady=!0),l.isInClient()?l.isLoggedIn()||window.Swal.fire({icon:"warning",title:"無法登入",text:"LINE LIFF 無法登入!",showDenyButton:!0,showCancelButton:!0,confirmButtonText:"再試一次",denyButtonText:"關閉"}).then((e=>{e.isConfirmed?v.push({name:"login"}):e.isDenied&&i("LINE LIFF 登入失敗",{autoClose:2e3})})):i("LINE LIFF 外部瀏覽器",{autoClose:2e3})})),(e,a)=>(g(),d("div",K,[0==E.value?(g(),d("div",P,a[1]||(a[1]=[c("img",{src:L,class:"card-img-top",alt:"PROME Title"},null,-1),c("p",{class:"logo-banner"},[c("img",{class:"object-fit-sm-contain border rounded-circle",style:{"max-width":"240px"},src:h,alt:"PROME Lion"})],-1)]))):f("",!0),1==E.value?(g(),d("div",b,[a[2]||(a[2]=c("img",{src:L,class:"card-img-top",alt:"PROME Title"},null,-1)),a[3]||(a[3]=c("div",{class:"card-body"},[c("h3",{class:"card-title"},[c("p",null,"訪問網站需要登入LINE，點選登入按鈕後繼續...")])],-1)),c("form",{class:"login-form",ref_key:"loginRef",ref:U,onSubmit:a[0]||(a[0]=p((()=>{}),["prevent"])),size:"large"},[c("p",{class:"logo-banner"},[c("img",{class:"imgbtn",src:"/promeliff/assets/btn_line_login-CFYjjMVw.png",onClick:B,alt:"LIFF Login"})])],544),c("div",A,[C.value?(g(),d("span",x,"登 入 中 ...")):(g(),d("span",F,"請先登入"))])])):f("",!0),2==E.value?(g(),d("div",y,[a[4]||(a[4]=S('<img src="'+L+'" class="card-img-top" alt="PROME Title" data-v-e560999f><div class="d-flex flex-wrap justify-content-center" data-v-e560999f><p class="logo-banner" data-v-e560999f><img class="object-fit-sm-contain border rounded-circle" style="max-width:220px;" src="'+h+'" alt="PROME Lion" data-v-e560999f></p><p class="logo-banner" data-v-e560999f><img class="object-fit-sm-contain" style="max-width:220px;" src="data:image/png;base64,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" alt="LINEBot" data-v-e560999f></p></div><h3 class="logo-banner" data-v-e560999f>請用LINE掃QR Code加好友或在LINE聊天室裡開啟本網頁</h3>',3)),c("p",j,u(J.value),1)])):f("",!0)]))}},[["__scopeId","data-v-e560999f"]]);export{E as default};
