import{_ as e,r as a,o as s,d as l,f as t,e as o,z as n,A as d,F as r,B as u,q as c,t as i,c as v,y as f,a as m,j as p}from"./BpdCzYEz.js";import{g as w,a as b,b as y}from"./DVot81TO.js";const x={class:"container-fluid",style:{margin:"0",padding:"0"}},q={class:"d-flex flex-wrap justify-content-center gap-2 w-100",style:{padding:"1em"}},g={class:"card card-fixed-wd"},h={class:"card-body"},_={class:"row mb-3"},z={class:"col-md-12"},I=["value"],k={key:0,class:"row"},$={class:"col-md-12"},N={key:1,class:"row"},S={key:2,class:"row mb-3"},j={class:"col-md-6"},C={class:"text-center"},R={class:"wqfont-size wqfont-size__blue"},M={class:"col-md-6"},T={class:"text-center"},A={class:"wqfont-size wqfont-size__red"},B={key:3,class:"d-flex flex-wrap justify-content-center"},E={key:4,class:"d-flex flex-wrap justify-content-center"},F={class:"row mb-3"},G={class:"col-md-12"},H={class:"wqfont-size wqfont-size__green"},O={class:"card-footer d-flex flex-wrap justify-content-center"},P=e({__name:"GetQNumber",setup(e){const P=m(),Q=a(100),U=a(110),V=a(""),D=a(null),J=a([]),K=a(!0),L=a({queNo:0});function W(){D.value=null;for(let e=0;e<J.value.length;e++)if(J.value[e].storeId==V.value){D.value=J.value[e];break}D.value&&(w({storeId:V.value}).then((e=>{e.data?(Q.value=e.data.currentNumber,U.value=e.data.newNumber):(Q.value=0,U.value=0)})).catch((e=>{v(`無法取得門市號碼: ${e.code} ${e.message||""}`,{autoClose:4e3})})),L.value={queNo:0},b({storeId:V.value}).then((e=>{e.data&&(L.value=e.data)})).catch((e=>{v(`無法取得使用者號碼: ${e.code} ${e.message||""}`,{autoClose:4e3})})))}return s((async()=>{Q.value=Math.floor(125*Math.random()),U.value=Q.value+Math.floor(12*Math.random()),function(){try{J.value=[{storeId:"STR1001",name:"開源總店",address:"開源路一段木人巷101號"},{storeId:"STR1002",name:"神室町店",address:"神室町天龍路一段木人巷102號"},{storeId:"STR1003",name:"花明一村店",address:"花明一村柳枝路一段桃花巷103號"},{storeId:"STR1004",name:"無事不登三宝店",address:"三宝路一段木人巷104號"},{storeId:"STR1005",name:"步行街邊店",address:"步行路一段行人巷105號"}]}catch(e){}finally{K.value=!1}}()})),(e,a)=>(p(),l("div",x,[t("div",q,[t("div",g,[a[11]||(a[11]=t("div",{class:"card-img-top"},null,-1)),t("div",h,[a[9]||(a[9]=t("h4",{class:"card-title text-center"},"排隊取號 ",-1)),a[10]||(a[10]=t("h2",{class:"text-center mb-4 wqfont-title"},"PROME 工具人",-1)),t("div",_,[t("div",z,[n(t("select",{"onUpdate:modelValue":a[0]||(a[0]=e=>V.value=e),class:"form-select",onChange:a[1]||(a[1]=e=>W())},[a[4]||(a[4]=t("option",{value:"",disabled:""},"-- 請選擇店家 --",-1)),(p(!0),l(r,null,u(J.value,(e=>(p(),l("option",{key:e.storeId,value:e.storeId},i(e.name),9,I)))),128))],544),[[d,V.value]])])]),null!=D.value?(p(),l("div",k,[t("div",$,[t("p",null,[a[5]||(a[5]=t("strong",null,"地址：",-1)),c(" "+i(D.value.address),1)])])])):o("",!0),null!=D.value?(p(),l("div",N,a[6]||(a[6]=[t("div",{class:"col-md-12"},[t("p",null,[t("strong",null,"電話："),c(" 03-123456789")])],-1)]))):o("",!0),null!=D.value?(p(),l("div",S,[t("div",j,[t("div",C,[a[7]||(a[7]=t("p",{class:"wqfont-size wqfont-size__blue"},"目前號碼",-1)),t("span",R,i(Q.value),1)])]),t("div",M,[t("div",T,[a[8]||(a[8]=t("p",{class:"wqfont-size wqfont-size__red"},"等待人數",-1)),t("span",A,i(U.value-Q.value),1)])])])):o("",!0),null!=D.value?(p(),l("div",B,[t("button",{class:"btn btn-primary fixed-size",onClick:a[2]||(a[2]=e=>{D.value?y({storeId:V.value}).then((e=>{e.data?(L.value=e.data,Swal.fire({title:`號碼: ${e.data.queNo}`,icon:"success"})):e.error&&Swal.fire({title:"無法取得門市號碼",text:`${e.error} ${e.extra.mesg||""}`,icon:"error"}),W()})).catch((e=>{v(`無法取得門市號碼: ${e.code} ${e.message||""}`,{autoClose:4e3})})):Swal.fire({title:"請先選擇門市",icon:"error"})})},"取號 "+i(U.value+1),1)])):o("",!0),null!=L.value&&L.value.queNo>0?(p(),l("div",E,[t("div",F,[t("div",G,[t("p",null,[t("strong",H," 我的號碼： "+i(L.value.queNo),1)])])])])):o("",!0)]),t("div",O,[t("button",{type:"button",class:"btn btn-outline-primary fixed-size me-2",onClick:a[3]||(a[3]=e=>{f((()=>{P.push({name:"Home"})}))})},"回首頁")])])])]))}},[["__scopeId","data-v-d949cf14"]]);export{P as default};
