import{_ as e,r as a,o as s,d as l,f as t,e as o,x as d,y as n,F as r,z as c,p as u,t as i,c as v,v as f,a as m,i as p}from"./oj9_mtiD.js";import{g as w,a as b,b as y}from"./CBHy55aN.js";import"./Da2dY_mR.js";const x={class:"container-fluid",style:{margin:"0",padding:"0"}},g={class:"d-flex flex-wrap justify-content-center gap-2 w-100",style:{padding:"1em"}},h={class:"card card-fixed-wd"},q={class:"card-body"},_={class:"row mb-3"},z={class:"col-md-12"},I=["value"],k={key:0,class:"row"},$={class:"col-md-12"},N={key:1,class:"row"},S={key:2,class:"row mb-3"},j={class:"col-md-6"},C={class:"text-center"},R={class:"wqfont-size wqfont-size__blue"},M={class:"col-md-6"},T={class:"text-center"},E={class:"wqfont-size wqfont-size__red"},F={key:3,class:"d-flex flex-wrap justify-content-center"},G={key:4,class:"d-flex flex-wrap justify-content-center"},H={class:"row mb-3"},O={class:"col-md-12"},P={class:"wqfont-size wqfont-size__green"},Q={class:"card-footer d-flex flex-wrap justify-content-center"},U=e({__name:"GetQNumber",setup(e){const U=m(),V=a(100),A=a(110),B=a(""),D=a(null),J=a([]),K=a(!0),L=a({queNo:0});function W(){D.value=null;for(let e=0;e<J.value.length;e++)if(J.value[e].storeId==B.value){D.value=J.value[e];break}D.value&&(w({storeId:B.value}).then((e=>{e.data?(V.value=e.data.currentNumber,A.value=e.data.newNumber):(V.value=0,A.value=0)})).catch((e=>{v(`無法取得門市號碼: ${e.code} ${e.message||""}`,{autoClose:4e3})})),L.value={queNo:0},b({storeId:B.value}).then((e=>{e.data&&(L.value=e.data)})).catch((e=>{v(`無法取得使用者號碼: ${e.code} ${e.message||""}`,{autoClose:4e3})})))}return s((async()=>{V.value=Math.floor(125*Math.random()),A.value=V.value+Math.floor(12*Math.random()),function(){try{J.value=[{storeId:"STR1001",name:"開源總店",address:"開源路一段木人巷101號"},{storeId:"STR1002",name:"神室町店",address:"神室町天龍路一段木人巷102號"},{storeId:"STR1003",name:"花明一村店",address:"花明一村柳枝路一段桃花巷103號"},{storeId:"STR1004",name:"無事不登三宝店",address:"三宝路一段木人巷104號"},{storeId:"STR1005",name:"步行街邊店",address:"步行路一段行人巷105號"}]}catch(e){}finally{K.value=!1}}()})),(e,a)=>(p(),l("div",x,[t("div",g,[t("div",h,[a[11]||(a[11]=t("div",{class:"card-img-top"},null,-1)),t("div",q,[a[9]||(a[9]=t("h4",{class:"card-title text-center"},"排隊取號 ",-1)),a[10]||(a[10]=t("h2",{class:"text-center mb-4 wqfont-title"},"PROME 工具人",-1)),t("div",_,[t("div",z,[d(t("select",{"onUpdate:modelValue":a[0]||(a[0]=e=>B.value=e),class:"form-select",onChange:a[1]||(a[1]=e=>W())},[a[4]||(a[4]=t("option",{value:"",disabled:""},"-- 請選擇店家 --",-1)),(p(!0),l(r,null,c(J.value,(e=>(p(),l("option",{key:e.storeId,value:e.storeId},i(e.name),9,I)))),128))],544),[[n,B.value]])])]),null!=D.value?(p(),l("div",k,[t("div",$,[t("p",null,[a[5]||(a[5]=t("strong",null,"地址：",-1)),u(" "+i(D.value.address),1)])])])):o("",!0),null!=D.value?(p(),l("div",N,a[6]||(a[6]=[t("div",{class:"col-md-12"},[t("p",null,[t("strong",null,"電話："),u(" 03-123456789")])],-1)]))):o("",!0),null!=D.value?(p(),l("div",S,[t("div",j,[t("div",C,[a[7]||(a[7]=t("p",{class:"wqfont-size wqfont-size__blue"},"目前號碼",-1)),t("span",R,i(V.value),1)])]),t("div",M,[t("div",T,[a[8]||(a[8]=t("p",{class:"wqfont-size wqfont-size__red"},"等待人數",-1)),t("span",E,i(A.value-V.value),1)])])])):o("",!0),null!=D.value?(p(),l("div",F,[t("button",{class:"btn btn-primary fixed-size",onClick:a[2]||(a[2]=e=>{D.value?y({storeId:B.value}).then((e=>{e.data?(L.value=e.data,Swal.fire({title:`號碼: ${e.data.queNo}`,icon:"success"})):e.error&&Swal.fire({title:"無法取得門市號碼",text:`${e.error} ${e.extra.mesg||""}`,icon:"error"}),W()})).catch((e=>{v(`無法取得門市號碼: ${e.code} ${e.message||""}`,{autoClose:4e3})})):Swal.fire({title:"請先選擇門市",icon:"error"})})},"取號 "+i(A.value+1),1)])):o("",!0),null!=L.value&&L.value.queNo>0?(p(),l("div",G,[t("div",H,[t("div",O,[t("p",null,[t("strong",P," 我的號碼： "+i(L.value.queNo),1)])])])])):o("",!0)]),t("div",Q,[t("button",{type:"button",class:"btn btn-outline-primary fixed-size me-2",onClick:a[3]||(a[3]=e=>{f((()=>{U.push({name:"Home"})}))})},"回首頁")])])])]))}},[["__scopeId","data-v-d949cf14"]]);export{U as default};
